import { useEffect,useState } from "react";import { io } from "socket.io-client";import { BACKEND_URL } from "../config";import { addScore, addHistory } from "../utils/storage";let socket;const CHOICES=["Rock","Paper","Scissors"];export default function RPS(){const [connected,setConnected]=useState(false);const [roomId,setRoomId]=useState("");const [name,setName]=useState("");const [status,setStatus]=useState("Not connected");const [result,setResult]=useState(null);useEffect(()=>{socket=io(BACKEND_URL);socket.on("connect",()=>setConnected(true));socket.on("roomData",(room)=>{setStatus(`Players: ${room.players.map(p=>p.name).join(", ")}`);});socket.on("rpsResult",(winner)=>{setResult(winner);addHistory("RPS",JSON.stringify(winner));if(winner&&winner.result==="Win") addScore("RPS",1);});return ()=>socket.disconnect();},[]);function join(){if(!roomId||!name) return alert("Room & name required");socket.emit("joinRoom",{roomId,playerName:name,game:"RPS"});}function newRoom(){const r=Math.random().toString(36).slice(2,8);setRoomId(r);if(name) socket.emit("joinRoom",{roomId:r,playerName:name,game:"RPS"});}function choose(choice){if(!roomId) return alert("Join a room first");socket.emit("move",{roomId,move:{player:name||"Player",choice}});setStatus("Waiting for opponent...");}return (<div className="container"><div className="card"><h2>Rock Paper Scissors (Multiplayer)</h2><div className="kv"><input className="name" placeholder="Your name" value={name} onChange={e=>setName(e.target.value)} /></div><div className="kv"><input className="room" placeholder="Room ID" value={roomId} onChange={e=>setRoomId(e.target.value)} /><button className="btn" onClick={join}>Join</button><button className="btn muted" onClick={newRoom}>New Room</button></div><div style={{marginTop:12}} className="center">{CHOICES.map(c=>(<button key={c} className="btn" onClick={()=>choose(c)}>{c}</button>))}</div><div style={{marginTop:12}} className="small">{status}</div>{result&&<div style={{marginTop:12}} className="card"><h3>Result</h3><div>{JSON.stringify(result)}</div></div>}</div></div>);}